class l{constructor(){this.baseUrl="https://www.googleapis.com/youtube/v3"}getApiKey(){return localStorage.getItem("youtube-api-key")||""}async makeRequest(e,t={}){var i;const n=this.getApiKey();if(!n)throw new Error("YouTube API key is required. Please set it in the header.");const r=new URL(`${this.baseUrl}/${e}`);r.searchParams.append("key",n),Object.entries(t).forEach(([o,u])=>{u!=null&&r.searchParams.append(o,u)});const a=await fetch(r);if(!a.ok){const o=await a.json().catch(()=>({}));throw new Error(((i=o.error)==null?void 0:i.message)||`API request failed: ${a.status}`)}return a.json()}extractChannelId(e){try{const n=new URL(e).pathname;return n.includes("/channel/")?n.split("/channel/")[1].split("/")[0]:(n.includes("/c/")||n.includes("/@"),null)}catch{return null}}async getChannelIdFromCustomUrl(e){try{const n=new URL(e).pathname;let r=null,a=null;n.includes("/c/")?a=n.split("/c/")[1].split("/")[0]:n.includes("/@")?a=n.split("/@")[1].split("/")[0]:n.includes("/user/")&&(r=n.split("/user/")[1].split("/")[0]);const i={};r?i.forUsername=r:a&&(i.forHandle=a),i.part="id";const o=await this.makeRequest("channels",i);if(o.items&&o.items.length>0)return o.items[0].id;throw new Error("Channel not found")}catch(t){throw new Error(`Could not resolve channel ID: ${t.message}`)}}async getChannelInfo(e){const t=await this.makeRequest("channels",{part:"snippet,statistics,brandingSettings",id:e});if(!t.items||t.items.length===0)throw new Error("Channel not found");return t.items[0]}async getChannelVideos(e,t=50){return(await this.makeRequest("search",{part:"id",channelId:e,type:"video",order:"date",maxResults:Math.min(t,50)})).items||[]}async getVideoDetails(e){const t=await this.makeRequest("videos",{part:"snippet,statistics,contentDetails",id:e});if(!t.items||t.items.length===0)throw new Error("Video not found");return t.items[0]}async getMultipleVideoDetails(e){if(!e||e.length===0)return[];const t=[];for(let r=0;r<e.length;r+=50)t.push(e.slice(r,r+50));const n=[];for(const r of t){const a=await this.makeRequest("videos",{part:"snippet,statistics,contentDetails",id:r.join(",")});a.items&&n.push(...a.items)}return n}async getTrendingVideos(e,t="20",n=50){return(await this.makeRequest("videos",{part:"id,snippet,statistics",chart:"mostPopular",regionCode:e,videoCategoryId:t,maxResults:Math.min(n,50)})).items||[]}async searchVideos(e,t={}){const n={part:"id,snippet",q:e,type:"video",maxResults:t.maxResults||25,order:t.order||"relevance"};return t.publishedAfter&&(n.publishedAfter=t.publishedAfter),t.regionCode&&(n.regionCode=t.regionCode),t.videoDuration&&(n.videoDuration=t.videoDuration),(await this.makeRequest("search",n)).items||[]}}const p=new l,w=s=>s==null?"0":s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),g=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",y=s=>{try{const e=new URL(s),t=new URLSearchParams(e.search);return e.hostname.includes("youtube.com")?t.get("v"):e.hostname.includes("youtu.be")?e.pathname.substring(1):null}catch(e){return console.error("Invalid URL:",e),null}},b=s=>s?s.split(`
`).map(e=>e.trim()).filter(e=>e.length>0):[],D=s=>{if(!s||s.length===0)return 0;const e=s.reduce((t,n)=>{var a;const r=parseInt(((a=n.statistics)==null?void 0:a.viewCount)||0);return t+r},0);return Math.round(e/s.length)},h=s=>{if(!s)return 0;const e=new Date(s),n=Math.abs(new Date-e);return Math.ceil(n/(1e3*60*60*24))},d=(s,e)=>h(s)<=e,c=(s,e)=>{if(!s)return!1;const t=new Date(s),n=new Date,r=new Date(n.getFullYear(),n.getMonth()-e,n.getDate());return t>=r},m=s=>d(s,30),f=s=>{if(!s)return!1;const e=new Date(s),t=new Date;return e.getFullYear()===t.getFullYear()},R=(s,e)=>s?s.filter(t=>{var r;const n=(r=t.snippet)==null?void 0:r.publishedAt;return e==="30days"?m(n):e==="3months"?c(n,3):e==="12months"?c(n,12):e==="2025"?f(n):!0}):[],C=s=>{if(!s||!s.statistics)return 0;const e=parseInt(s.statistics.viewCount||0),t=parseInt(s.statistics.likeCount||0),n=parseInt(s.statistics.commentCount||0);return e===0?0:((t+n)/e*100).toFixed(2)};export{R as a,g as b,D as c,C as d,y as e,w as f,b as p,p as y};
