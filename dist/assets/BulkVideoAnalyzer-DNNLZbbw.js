import{u as V,r as u,j as e,B as f}from"./index-C6AhWlL7.js";import{C as y,a as N,b as C,c as R,e as k}from"./card-Dl2Li3Yj.js";import{T as z}from"./textarea-DaUGOsBn.js";import{T as E,a as L,b as w,c as o,d as I,e as c}from"./table-DvSDxIKz.js";import{f as x,b as D,p as $,e as B,y as H,d as P}from"./helpers-BDDNww03.js";import{D as F}from"./download-DTWDoFlQ.js";function J(){const{setLoading:p,setError:g}=V(),[h,A]=u.useState(""),[d,j]=u.useState([]),[b,v]=u.useState(!1),T=async()=>{if(h.trim()){v(!0),p(!0),g(null),j([]);try{const t=$(h);if(t.length===0)throw new Error("No valid URLs provided");const n=[];for(const i of t)try{const l=B(i);if(!l){console.error(`Could not extract video ID from URL: ${i}`);continue}const s=await H.getVideoDetails(l),r=P(s),a=s.contentDetails.duration,m=S(a);n.push({channelName:s.snippet.channelTitle,videoUrl:i,viewCount:parseInt(s.statistics.viewCount),likes:parseInt(s.statistics.likeCount||0),comments:parseInt(s.statistics.commentCount||0),publishedDate:s.snippet.publishedAt,duration:m,engagementRate:parseFloat(r)})}catch(l){console.error(`Error processing video URL: ${i}`,l)}j(n)}catch(t){console.error("Error analyzing videos:",t),g(t.message||"Failed to analyze videos. Please try again.")}finally{v(!1),p(!1)}}},S=t=>{const n=t.match(/PT(\d+H)?(\d+M)?(\d+S)?/),i=(n[1]||"").replace("H",""),l=(n[2]||"").replace("M",""),s=(n[3]||"").replace("S",""),r=i?parseInt(i):0,a=l?parseInt(l):0,m=s?parseInt(s):0;return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`},U=()=>{if(d.length===0)return;const t=["Channel Name","Video URL","Views","Likes","Comments","Duration","Publish Date","Engagement Rate"],n=d.map(a=>[`"${a.channelName.replace(/"/g,'""')}"`,`"${a.videoUrl.replace(/"/g,'""')}"`,a.viewCount,a.likes,a.comments,`"${a.duration.replace(/"/g,'""')}"`,`"${D(a.publishedDate).replace(/"/g,'""')}"`,a.engagementRate].join(",")),i=[t.join(","),...n].join(`
`),l=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(l),r=document.createElement("a");r.setAttribute("href",s),r.setAttribute("download","bulk_video_analysis.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)};return e.jsxs("div",{className:"container mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Bulk Video Analyzer"}),e.jsxs(y,{className:"mb-8",children:[e.jsxs(N,{children:[e.jsx(C,{children:"Enter YouTube Video URLs"}),e.jsx(R,{children:"Analyze multiple YouTube videos at once"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{placeholder:"https://www.youtube.com/watch?v=...\\nhttps://youtu.be/...",value:h,onChange:t=>A(t.target.value),className:"min-h-32"}),e.jsx(f,{onClick:T,disabled:b||!h.trim(),className:"w-full sm:w-auto",children:b?"Analyzing...":"Analyze Videos"})]})})]}),d.length>0&&e.jsxs(y,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Analysis Results"}),e.jsxs(R,{children:["Analyzed ",d.length," videos"]})]}),e.jsxs(f,{onClick:U,variant:"outline",size:"sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"})," Export to CSV"]})]})}),e.jsx(k,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(E,{children:[e.jsx(L,{children:e.jsxs(w,{children:[e.jsx(o,{children:"Channel Name"}),e.jsx(o,{children:"Video URL"}),e.jsx(o,{className:"text-right",children:"Views"}),e.jsx(o,{className:"text-right",children:"Likes"}),e.jsx(o,{className:"text-right",children:"Comments"}),e.jsx(o,{className:"text-right",children:"Duration"}),e.jsx(o,{className:"text-right",children:"Publish Date"}),e.jsx(o,{className:"text-right",children:"Engagement Rate"})]})}),e.jsx(I,{children:d.map((t,n)=>e.jsxs(w,{children:[e.jsx(c,{className:"font-medium",children:t.channelName}),e.jsx(c,{children:e.jsx("a",{href:t.videoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Link"})}),e.jsx(c,{className:"text-right",children:x(t.viewCount)}),e.jsx(c,{className:"text-right",children:x(t.likes)}),e.jsx(c,{className:"text-right",children:x(t.comments)}),e.jsx(c,{className:"text-right",children:t.duration}),e.jsx(c,{className:"text-right",children:D(t.publishedDate)}),e.jsxs(c,{className:"text-right",children:[t.engagementRate,"%"]})]},n))})]})})})]})]})}export{J as default};
